digraph addresses {
  graph[compound=true];
  node [shape=box];

  payment_address [label = "Payment Address"];
  byron_address [label = "Byron Address"];
  stake_address [label = "Stake Address"];

  payment_credential [label = "Payment Credential"];
  stake_credential [label = "Stake Credential"];
  stake_credential2 [label = "Stake Credential"];

  pvkh [label = "Payment Verification\nKey Hash"];
  psh [label = "Script Hash"];
  svkh [label = "Stake Verification\nKey Hash"];
  ssh [label = "Script Hash"];

  by_value [label = "By Value"];
  by_reference [label = "By Reference"];
  null [label = "null"];

  subgraph cluster_stake {
    stake_address
    stake_credential2
    svkh
    ssh
  }

  subgraph cluster_payment {
    payment_address byron_address payment_credential stake_credential
    pvkh psh by_value by_reference null
    by_value by_reference null


    subgraph cluster_shelley {
      label = "Shelley Address"
      payment_credential
      stake_credential
    }

  }

  payment_address -> byron_address;
  payment_address -> payment_credential [lhead = cluster_shelley];
  payment_credential ->  {pvkh, psh};
  stake_credential -> {by_value, by_reference, null};

  by_value -> stake_credential2 [style = dashed, constraint=false];

  stake_address -> stake_credential2;
  stake_credential2 -> {svkh, ssh};
}
